<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Leadspire - Leadership Registration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        background: linear-gradient(to right, #e9a5f1, #e69db8, #ffdee9);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
        animation: gradientFlow 12s ease infinite;
        background-size: 300% 300%;
      }

      @keyframes gradientFlow {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }
      .leadspire-gradient {
        background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
      }
      .form-card {
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05);
      }
      .input-field:focus {
        border-color: #8b5cf6;
        box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
      }
      .radio-input:checked + .radio-label {
        background-color: #8b5cf6;
        color: white;
        border-color: #8b5cf6;
      }
    </style>
  </head>
  <body class="min-h-screen flex items-center justify-center p-2 sm:p-4">
    <div class="w-full max-w-md">
      <!-- Header with Leadspire branding -->
      <div class="text-center mb-4 sm:mb-8">
        <h1 class="text-3xl font-bold text-gray-900 mb-2">Leadspire</h1>
        <p class="text-lg text-gray-600 mb-3">Building Tomarrow</p>
      </div>

      <div class="bg-white rounded-xl form-card p-4 sm:p-8">
        <form id="registrationForm" class="space-y-6" action="#" method="POST">
          <!-- Name -->
          <div>
            <label
              for="name"
              class="block text-sm font-medium text-gray-700 mb-1"
              >Full Name</label
            >
            <div class="relative">
              <div
                class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
              >
                <svg
                  class="h-5 w-5 text-gray-400"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                  />
                </svg>
              </div>
              <input
                type="text"
                id="name"
                name="name"
                required
                placeholder="Enter Your Name"
                class="pl-10 input-field w-full rounded-md border border-gray-300 py-2 px-4 bg-white text-gray-700 placeholder-gray-400 focus:outline-none"
              />
            </div>
          </div>

          <!-- Contact -->
          <div>
            <label
              for="contact"
              class="block text-sm font-medium text-gray-700 mb-1"
              >Contact Number</label
            >
            <div class="relative">
              <div
                class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
              >
                <svg
                  class="h-5 w-5 text-gray-400"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
                  />
                </svg>
              </div>
              <input
                type="tel"
                id="contact"
                name="contact"
                required
                placeholder="9876543210"
                class="pl-10 input-field w-full rounded-md border border-gray-300 py-2 px-4 bg-white text-gray-700 placeholder-gray-400 focus:outline-none"
              />
            </div>
          </div>

          <!-- District -->
          <div>
            <label
              for="district"
              class="block text-sm font-medium text-gray-700 mb-1"
              >District</label
            >
            <div class="relative">
              <select
                id="district"
                name="district"
                required
                class="input-field w-full rounded-md border border-gray-300 py-2 px-4 bg-white text-gray-700 focus:outline-none appearance-none"
              >
                <option value="" disabled selected>Select your district</option>
                <option>Thiruvananthapuram</option>
                <option>Kollam</option>
                <option>Pathanamthitta</option>
                <option>Alappuzha</option>
                <option>Kottayam</option>
                <option>Idukki HR</option>
                <option>Idukki LR</option>
                <option>Ernakulam</option>
                <option>Thrissur</option>
                <option>Palakkad</option>
                <option>Malappuram West</option>
                <option>Malappuram East</option>
                <option>Kozhikode South</option>
                <option>Kozhikode North</option>
                <option>Wayanad</option>
                <option>Kannur</option>
                <option>Kasaragod</option>
                <option>Nilgris</option>
              </select>
              <div
                class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none"
              >
                <svg
                  class="h-5 w-5 text-gray-400"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M19 9l-7 7-7-7"
                  />
                </svg>
              </div>
            </div>
          </div>

          <!-- Position -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"
              >Position</label
            >
            <div class="grid grid-cols-2 gap-3">
              <div>
                <input
                  type="radio"
                  id="syndicate"
                  name="position"
                  value="syndicate"
                  class="hidden radio-input"
                  required
                />
                <label
                  for="syndicate"
                  class="radio-label cursor-pointer block w-full py-2 px-4 border rounded-md text-sm font-medium text-gray-700 text-center radio-option"
                >
                  District Campus Syndicate
                </label>
              </div>
              <div>
                <input
                  type="radio"
                  id="campus"
                  name="position"
                  value="campus_secretary"
                  class="hidden radio-input"
                />
                <label
                  for="campus"
                  class="radio-label cursor-pointer block w-full py-2 px-4 border rounded-md text-sm font-medium text-gray-700 text-center radio-option"
                >
                  Division Campus Secretary
                </label>
              </div>
            </div>
          </div>

          <!-- Division (will be shown only if campus secretary is selected) -->
          <div id="divisionContainer" class="hidden">
            <label
              for="division"
              class="block text-sm font-medium text-gray-700 mb-1"
              >Division</label
            >
            <div class="relative">
              <select
                id="division"
                name="division"
                class="input-field w-full rounded-md border border-gray-300 py-2 px-4 bg-white text-gray-700 focus:outline-none appearance-none"
              >
                <option value="" disabled selected>Select your division</option>
              </select>
              <div
                class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none"
              >
                <svg
                  class="h-5 w-5 text-gray-400"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M19 9l-7 7-7-7"
                  />
                </svg>
              </div>
            </div>
          </div>

          <!-- Submit -->
          <div class="pt-2">
            <button
              id="submitBtn"
              type="submit"
              class="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all duration-200"
            >
              Complete Registration
              <svg
                class="ml-2 -mr-1 h-5 w-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M14 5l7 7m0 0l-7 7m7-7H3"
                />
              </svg>
            </button>
          </div>
        </form>
      </div>

      <!-- Success Modal -->
      <div
        id="successModal"
        class="fixed hidden inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full"
      >
        <div
          class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"
        >
          <div class="mt-3 text-center">
            <div
              class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100"
            >
              <svg
                class="h-6 w-6 text-green-600"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M5 13l4 4L19 7"
                />
              </svg>
            </div>
            <h3 class="text-lg leading-6 font-medium text-gray-900 mt-3">
              Registration Successful!
            </h3>
            <div class="mt-2 px-7 py-3">
              <p class="text-sm text-gray-500 modal-message">
                Thank you for registering with Leadspire.
              </p>
            </div>
            <div class="items-center px-4 py-3">
              <button
                class="modal-close px-4 py-2 bg-indigo-600 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"
              >
                OK
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="text-center mt-6 text-sm text-gray-500">
        "The best of people are those who are most beneficial to people."
        <span class="block mt-1 text-xs text-gray-400"
          >— Prophet Muhammad ﷺ (Al-Mu'jam al-Awsat)</span
        >
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const districtSelect = document.getElementById("district");
        const positionRadios = document.querySelectorAll(
          'input[name="position"]'
        );
        const divisionContainer = document.getElementById("divisionContainer");
        const divisionSelect = document.getElementById("division");

        // Listen for district changes to update divisions if needed
        districtSelect.addEventListener("change", function () {
          if (document.getElementById("campus").checked) {
            updateDivisionOptions();
          }
        });

        // Listen for position changes
        positionRadios.forEach((radio) => {
          radio.addEventListener("change", function () {
            if (this.value === "campus_secretary") {
              divisionContainer.classList.remove("hidden");
              updateDivisionOptions();
            } else {
              divisionContainer.classList.add("hidden");
              divisionSelect.selectedIndex = 0;
            }
          });
        });

        // Function to update division options based on selected district
        function updateDivisionOptions() {
          const district = districtSelect.value;
          if (!district) return;

          google.script.run
            .withSuccessHandler(function (divisions) {
              // Clear existing options
              while (divisionSelect.options.length > 1) {
                divisionSelect.remove(1);
              }

              // Add new options
              divisions.forEach((division) => {
                const option = document.createElement("option");
                option.value = division;
                option.textContent = division;
                divisionSelect.appendChild(option);
              });
            })
            .getDivisions(district);
        }
      });

      document
        .getElementById("registrationForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const submitBtn = document.getElementById("submitBtn");
          const originalText = submitBtn.innerHTML;
          submitBtn.disabled = true;
          submitBtn.innerHTML = `
          <svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white inline" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          Processing...
        `;

          const formData = {
            name: document.getElementById("name").value,
            contact: document.getElementById("contact").value,
            district: document.getElementById("district").value,
            division:
              document.getElementById("division").value || "Not applicable",
            position:
              document.querySelector('input[name="position"]:checked')?.value ||
              "",
          };

          if (
            !formData.name ||
            !formData.contact ||
            !formData.district ||
            !formData.position
          ) {
            showAlert("Please fill in all required fields");
            submitBtn.disabled = false;
            submitBtn.innerHTML = originalText;
            return;
          }

          // Additional validation for campus secretary
          if (
            formData.position === "campus_secretary" &&
            (!formData.division || formData.division === "Select your division")
          ) {
            showAlert("Please select your division");
            submitBtn.disabled = false;
            submitBtn.innerHTML = originalText;
            return;
          }

          google.script.run
            .withSuccessHandler(function (response) {
              if (response.success) {
                showSuccessModal(response.message);
                document.getElementById("registrationForm").reset();
                document
                  .getElementById("divisionContainer")
                  .classList.add("hidden");
              } else {
                showAlert(response.message);
              }
              submitBtn.disabled = false;
              submitBtn.innerHTML = originalText;
            })
            .withFailureHandler(function (error) {
              showAlert("Registration failed. Please try again later.");
              console.error("Error:", error);
              submitBtn.disabled = false;
              submitBtn.innerHTML = originalText;
            })
            .submitData(formData);
        });

      function showSuccessModal(message) {
        const modal = document.getElementById("successModal");
        const messageElement = modal.querySelector(".modal-message");
        messageElement.textContent =
          message || "Thank you for registering with Leadspire.";
        modal.classList.remove("hidden");
      }

      function showAlert(message) {
        const alertDiv = document.createElement("div");
        alertDiv.className =
          "mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded relative";
        alertDiv.role = "alert";
        alertDiv.innerHTML = `
          <span class="block sm:inline">${message}</span>
          <span class="absolute top-0 bottom-0 right-0 px-4 py-3 alert-close">
            <svg class="fill-current h-6 w-6 text-red-500" role="button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
              <title>Close</title>
              <path d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"/>
            </svg>
          </span>
        `;

        const container = document.querySelector(".form-card");
        container.prepend(alertDiv);

        alertDiv.querySelector(".alert-close").addEventListener("click", () => {
          alertDiv.remove();
        });

        setTimeout(() => {
          if (document.body.contains(alertDiv)) {
            alertDiv.remove();
          }
        }, 5000);
      }

      document
        .querySelector(".modal-close")
        .addEventListener("click", function () {
          document.getElementById("successModal").classList.add("hidden");
        });
    </script>
  </body>
</html>
